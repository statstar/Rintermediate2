# 교차검정(카이제곱검정)
범주형 * 범주형 

# 1. 교차분석표
table(mtcars$vs, mtcars$cyl)

# 2. 시각화 방법
table(mtcars$vs, mtcars$cyl) %>% 
  barplot(., beside=T, legend=rownames(.), 
          col=c("tomato3", "cornflowerblue"))

# 3. 가설검정
table(mtcars$vs, mtcars$cyl) %>% 
  chisq.test()

table(mtcars$vs, mtcars$cyl) %>% 
  fisher.test()


# 일원배치분산분석
## 1. 시각화
boxplot(mpg~gear, mtcars)

## 2. 요약값
mtcars %>% 
  group_by(gear) %>% 
  summarise(n=n(), 평균=mean(mpg), 표준편차=sd(mpg))

## 3. 등분산여부
var.test(mpg~gear, mtcars) # ERROR
bartlett.test(mpg~gear, mtcars)
library(car)
leveneTest(mpg~factor(gear), mtcars)

## 4. 등분산 만족
aov(mpg~gear, mtcars) %>% summary
aov1 <- aov(mpg~factor(cyl), mtcars) 
TukeyHSD(aov1)

oneway.test(mpg~gear, mtcars)

kruskal.test(mpg~gear, mtcars)
# 이원배치분산분석

